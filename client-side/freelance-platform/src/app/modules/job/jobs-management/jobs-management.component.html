<div class="container">
    <h1>My jobs</h1>
    <div class="table-actions">
        <button mat-raised-button color="primary" (click)="openCreateJobDialog()">Create</button>
    </div>
        <table mat-table matSort [dataSource]="jobs">
            <ng-container matColumnDef="title">
                <th mat-header-cell *matHeaderCellDef class="title" mat-sort-header style="width: 50%;"> <h3>Title</h3> </th>
                <td mat-cell *matCellDef="let element" class="title" style="width: 50%;"> {{element.title}} </td>
            </ng-container>
            <ng-container matColumnDef="numOfProposals">
                <th mat-header-cell *matHeaderCellDef class="proposals" style="width: 5%;" mat-sort-header> <h3>Proposals</h3> </th>
                <td mat-cell *matCellDef="let element" class="proposals" style="width: 5%;">{{element.numOfProposals}}</td>
            </ng-container>
            <ng-container matColumnDef="interviewing">
                <th mat-header-cell *matHeaderCellDef class="interviewing" style="width: 5%;" mat-sort-header> <h3>Interviewing</h3> </th>
                <td mat-cell *matCellDef="let element" class="interviewing" style="width: 5%;">
                    <span *ngIf="element.status !== 2">{{element.currentlyInterviewing}}</span>
                    <span *ngIf="element.status === 2">/</span>
                </td>
            </ng-container>
            <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef class="interviewing" style="width: 5%;" mat-sort-header> <h3>Status</h3> </th>
                <td mat-cell *matCellDef="let element" class="interviewing" style="width: 5%;">{{enumConverter.jobStatusToString(element.status)}}</td>
            </ng-container>
            <ng-container matColumnDef="activeContracts">
                <th mat-header-cell *matHeaderCellDef class="activeContracts" style="width: 5%;" mat-sort-header> <h3>Active Contracts</h3> </th>
                <td mat-cell *matCellDef="let element" class="activeContracts" style="width: 5%;">{{element.numOfActiveContracts}}</td>
            </ng-container>
            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef style="width: 30%;"></th>
                <td mat-cell *matCellDef="let element" class="job-actions" style="width: 30%;">
                    <button mat-mini-fab color="primary" title="Full info" *ngIf="hoveredRow === element" (click)="openJobInfoDialog(element)">
                        <mat-icon>more_horiz</mat-icon>
                    </button>
                    <button mat-mini-fab color="primary" title="Proposals" *ngIf="hoveredRow === element" [routerLink]="['/job', element.id, 'proposal-management']">
                        <mat-icon>handshake</mat-icon>
                    </button>
                    <button mat-mini-fab color="primary" title="Contracts" *ngIf="hoveredRow === element && element.numOfActiveContracts > 0" [routerLink]="['/job', element.id, 'contract-management']">
                        <mat-icon>cases</mat-icon>
                    </button>
                    <button class="done-button" *ngIf="element.status === 1 && hoveredRow === element" mat-mini-fab title="Job done" (click)="jobDone(element)">
                        <mat-icon>done</mat-icon>
                    </button>
                    <button mat-mini-fab color="warn" title="Delete" *ngIf="hoveredRow === element" (click)="deleteJob(element)">
                        <mat-icon>delete</mat-icon>
                    </button>
                </td>
            </ng-container>
    
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
                (mouseenter)="hoveredRow = row" (mouseleave)="hoveredRow = null">
            </tr>
        </table>
</div>
